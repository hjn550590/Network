# 通过网络边界的流量判断用户的点击行为

## 目标
**基于HTTP请求响应特征定位用户点击行为**

    从pcap文件中提取http请求对的信息，观察用户点击引起的数目和头部信息的变化，总结特征。

## 发现
1. 用户从一个网站的主页进入到另一个网站的主页时，第一个请求的包的类型为document，且请求的url的相对路径为**‘／’**
2. 用户的点击动作会引起很多对象的请求，包括图片和js、css文件等，由于这些对象都是根据documnet文件的资源要求请求的，所以这些对象的referer域都指向该页面。由此推断，当很多个包的referer域都为同一个url的时候，就是出现了进入到该url的点击动作。

## 实现
>  使用python的一个依赖包dpkt来读取pcap和pcapng文件

1. 读取每一个包含http报文的数据包信息
2. 判断该http包是否为document的请求包，如果是，就记下这个包的timestamp
3. 对http请求包的referer域进行统计，如果referer域不指向某一个css或者js文件，则将该referer计数器加一
4. 对于出现次数多于1的referer域，考虑在第二步得到的请求包的request.uri中匹配该referer域（注意相对路径和绝对路径的差异）如果可以找到匹配，或者request.uri为'/'，则输出该请求，判定为一个用户点击动作。
